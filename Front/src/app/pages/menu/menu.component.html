<div class="bg-particles"></div>

<div class="container">
    <div class="menu-logo">
        <!-- Minecraft pixel art logo SVG -->
        <svg width="54" height="38" viewBox="0 0 54 38" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="26" width="50" height="10" rx="2" fill="#3e5227" stroke="#b6e53e" stroke-width="2"/>
            <rect x="8" y="8" width="38" height="20" rx="4" fill="#b6e53e" stroke="#3e5227" stroke-width="2"/>
            <rect x="14" y="14" width="26" height="8" rx="2" fill="#fff" stroke="#3e5227" stroke-width="1.5"/>
            <rect x="20" y="18" width="14" height="4" rx="1.5" fill="#3e5227"/>
            <rect x="10" y="32" width="8" height="4" rx="2" fill="#222"/>
            <rect x="36" y="32" width="8" height="4" rx="2" fill="#222"/>
        </svg>
    </div>

    <nav class="menu">
        <h1>Juego "Sopa de Letras"</h1>
        <ul>
            <li style="position: relative;">
                <button (click)="showPuzzleMenu = !showPuzzleMenu">Jugar</button>
                
                <!-- MenÃº de puzzles mejorado -->
                <div class="difficulty-menu" *ngIf="showPuzzleMenu">
                    <div class="difficulty-menu-content">
                        <h2>Elige un Puzzle</h2>
                        
                        <!-- Botones para cambiar entre tipos de puzzles -->
                        <div class="puzzle-type-buttons">
                            <button 
                                (click)="showSystemLevels()" 
                                [class.active]="showDefaultPuzzles"
                                class="type-btn">
                                ðŸŽ® Niveles del Sistema
                            </button>
                            <button 
                                (click)="showCustomCreatedPuzzles()" 
                                [class.active]="showCustomPuzzles"
                                class="type-btn">
                                ðŸŽ¨ Puzzles Creados
                            </button>
                        </div>

                        <!-- Niveles del Sistema -->
                        <div *ngIf="showDefaultPuzzles" class="puzzle-section">
                            <h3>ðŸŽ® Niveles Predefinidos</h3>
                            <ng-container *ngIf="defaultPuzzles.length > 0; else noDefaultPuzzles">
                                <button
                                    *ngFor="let puzzle of defaultPuzzles"
                                    (click)="selectPuzzle(puzzle.id)"
                                    class="puzzle-option default-puzzle">
                                    <div class="puzzle-info">
                                        <span class="puzzle-name">{{ puzzle.name }}</span>
                                        <span class="puzzle-difficulty">
                                            {{ getDifficultyIcon(puzzle.difficulty) }}
                                            {{ getDifficultyLabel(puzzle.difficulty) }}
                                        </span>
                                        <span class="puzzle-size">{{ getPuzzleSize(puzzle) }}</span>
                                        <span class="puzzle-questions">{{ getQuestionCount(puzzle) }} preguntas</span>
                                    </div>
                                </button>
                            </ng-container>
                            <ng-template #noDefaultPuzzles>
                                <p>No hay niveles del sistema disponibles.</p>
                            </ng-template>
                        </div>

                        <!-- Puzzles Personalizados -->
                        <div *ngIf="showCustomPuzzles" class="puzzle-section">
                            <h3>ðŸŽ¨ Tus Puzzles Personalizados</h3>
                            
                            <!-- BotÃ³n para crear nuevo puzzle -->
                            <button (click)="goToCreateCustomPuzzle()" class="create-puzzle-btn">
                                âž• Crear Nuevo Puzzle
                            </button>

                            <!-- Lista de puzzles personalizados -->
                            <ng-container *ngIf="customPuzzles.length > 0; else noCustomPuzzles">
                                <button
                                    *ngFor="let puzzle of customPuzzles"
                                    (click)="selectPuzzle(puzzle.id)"
                                    class="puzzle-option custom-puzzle">
                                    <div class="puzzle-info">
                                        <span class="puzzle-name">{{ puzzle.name }}</span>
                                        <span class="puzzle-type">{{ getPuzzleTypeLabel(puzzle) }}</span>
                                        <span class="puzzle-difficulty">
                                            {{ getDifficultyIcon(puzzle.difficulty) }}
                                            {{ getDifficultyLabel(puzzle.difficulty) }}
                                        </span>
                                        <span class="puzzle-size">{{ getPuzzleSize(puzzle) }}</span>
                                        <span class="puzzle-questions">{{ getQuestionCount(puzzle) }} preguntas</span>
                                    </div>
                                </button>
                            </ng-container>
                            
                            <ng-template #noCustomPuzzles>
                                <div class="empty-custom-puzzles">
                                    <p>ðŸŽ¨ No tienes puzzles personalizados aÃºn.</p>
                                    <p>Â¡Crea tu primer puzzle personalizado!</p>
                                </div>
                            </ng-template>
                        </div>

                        <button (click)="closePuzzleMenu()" class="cancel-btn">Cancelar</button>
                    </div>
                </div>
            </li>
            <li><button (click)="scoreboard()">Puntaje</button></li>
            <li><button (click)="router.navigate(['/admin'])">Admin</button></li>
        </ul>
    </nav>
</div>

<!-- CinemÃ¡tica Modal -->
<div class="cinematic-modal" *ngIf="showTutorial">
    <div class="cinematic-bg" [ngStyle]="{'background-image': 'url(' + tutorialBg + ')'}"></div>
    <div class="cinematic-content">
        <h2>Â¡Bienvenido/a a Lexaria.dev!</h2>
        <p>
            Un joven developer absorbido por un glitch dimensional mientras compilaba su proyecto final de carrera. 
            Despierta en Lexaria.dev, un universo olvidado donde cada lÃ­nea de cÃ³digo tiene peso real y los 
            Lenguajes de ProgramaciÃ³n son fuerzas elementales.<br><br>            
            El sistema operativo que gobierna este mundo estÃ¡ corrupto, y el equilibrio del lenguaje ha sido roto 
            por un bug ancestral. Solo encontrando las Palabras Clave en cada regiÃ³n (mapa), podrÃ¡s reactivar los 
            Glifos SintÃ¡cticos que restauran el orden y desbloquean nuevas funciones del sistema.<br><br>
            Cada mapa representa un entorno de desarrollo mÃ­stico (como bosques con estructuras de datos, ruinas 
            de lenguajes obsoletos o servidores abandonados).<br>
            <b>Tu misiÃ³n:</b> debuggear el mundo y restaurar el cÃ³digo fuente de la realidad.
        </p>
        <button (click)="closeCinematicAndShowDifficulty()">Continuar</button>
    </div>
</div>